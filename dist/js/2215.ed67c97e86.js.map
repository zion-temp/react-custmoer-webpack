{"version":3,"sources":["webpack://react-custmoer-webpack/./node_modules/rc-motion/es/hooks/useStatus.js"],"names":["useStatus","supportMotion","visible","getElement","_ref","_ref$motionEnter","motionEnter","_ref$motionAppear","motionAppear","_ref$motionLeave","motionLeave","motionDeadline","motionLeaveImmediately","onAppearPrepare","onEnterPrepare","onLeavePrepare","onAppearStart","onEnterStart","onLeaveStart","onAppearActive","onEnterActive","onLeaveActive","onAppearEnd","onEnterEnd","onLeaveEnd","onVisibleChanged","_useState","_useState2","asyncVisible","setAsyncVisible","_useState3","_useState4","status","setStatus","_useState5","_useState6","style","setStyle","mountedRef","useRef","deadlineRef","destroyedRef","cacheElementRef","getDomElement","current","activeRef","onInternalMotionEnd","event","canEnd","element","deadline","target","_useDomMotionEvents","patchMotionEvents","eventHandlers","_ref2","_ref3","_ref4","_useStepQueue","newStep","onPrepare","_eventHandlers$step","step","call","clearTimeout","setTimeout","_useStepQueue2","startStep","active","nextStatus","isMounted","useEffect","undefined","mergedStyle","transition"],"mappings":"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","file":"js/2215.ed67c97e86.js","sourcesContent":["import _objectSpread from \"@babel/runtime/helpers/esm/objectSpread2\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport * as React from 'react';\nimport { useRef, useEffect } from 'react';\nimport { STATUS_APPEAR, STATUS_NONE, STATUS_LEAVE, STATUS_ENTER, STEP_PREPARE, STEP_START, STEP_ACTIVE } from '../interface';\nimport useState from './useState';\nimport useIsomorphicLayoutEffect from './useIsomorphicLayoutEffect';\nimport useStepQueue, { DoStep, SkipStep, isActive } from './useStepQueue';\nimport useDomMotionEvents from './useDomMotionEvents';\nexport default function useStatus(supportMotion, visible, getElement, _ref) {\n  var _ref$motionEnter = _ref.motionEnter,\n      motionEnter = _ref$motionEnter === void 0 ? true : _ref$motionEnter,\n      _ref$motionAppear = _ref.motionAppear,\n      motionAppear = _ref$motionAppear === void 0 ? true : _ref$motionAppear,\n      _ref$motionLeave = _ref.motionLeave,\n      motionLeave = _ref$motionLeave === void 0 ? true : _ref$motionLeave,\n      motionDeadline = _ref.motionDeadline,\n      motionLeaveImmediately = _ref.motionLeaveImmediately,\n      onAppearPrepare = _ref.onAppearPrepare,\n      onEnterPrepare = _ref.onEnterPrepare,\n      onLeavePrepare = _ref.onLeavePrepare,\n      onAppearStart = _ref.onAppearStart,\n      onEnterStart = _ref.onEnterStart,\n      onLeaveStart = _ref.onLeaveStart,\n      onAppearActive = _ref.onAppearActive,\n      onEnterActive = _ref.onEnterActive,\n      onLeaveActive = _ref.onLeaveActive,\n      onAppearEnd = _ref.onAppearEnd,\n      onEnterEnd = _ref.onEnterEnd,\n      onLeaveEnd = _ref.onLeaveEnd,\n      onVisibleChanged = _ref.onVisibleChanged;\n\n  // Used for outer render usage to avoid `visible: false & status: none` to render nothing\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      asyncVisible = _useState2[0],\n      setAsyncVisible = _useState2[1];\n\n  var _useState3 = useState(STATUS_NONE),\n      _useState4 = _slicedToArray(_useState3, 2),\n      status = _useState4[0],\n      setStatus = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      style = _useState6[0],\n      setStyle = _useState6[1];\n\n  var mountedRef = useRef(false);\n  var deadlineRef = useRef(null);\n  var destroyedRef = useRef(false); // =========================== Dom Node ===========================\n\n  var cacheElementRef = useRef(null);\n\n  function getDomElement() {\n    var element = getElement();\n    return element || cacheElementRef.current;\n  } // ========================== Motion End ==========================\n\n\n  var activeRef = useRef(false);\n\n  function onInternalMotionEnd(event) {\n    var element = getDomElement();\n\n    if (event && !event.deadline && event.target !== element) {\n      // event exists\n      // not initiated by deadline\n      // transitionEnd not fired by inner elements\n      return;\n    }\n\n    var canEnd;\n\n    if (status === STATUS_APPEAR && activeRef.current) {\n      canEnd = onAppearEnd === null || onAppearEnd === void 0 ? void 0 : onAppearEnd(element, event);\n    } else if (status === STATUS_ENTER && activeRef.current) {\n      canEnd = onEnterEnd === null || onEnterEnd === void 0 ? void 0 : onEnterEnd(element, event);\n    } else if (status === STATUS_LEAVE && activeRef.current) {\n      canEnd = onLeaveEnd === null || onLeaveEnd === void 0 ? void 0 : onLeaveEnd(element, event);\n    } // Only update status when `canEnd` and not destroyed\n\n\n    if (canEnd !== false && !destroyedRef.current) {\n      setStatus(STATUS_NONE);\n      setStyle(null);\n    }\n  }\n\n  var _useDomMotionEvents = useDomMotionEvents(onInternalMotionEnd),\n      _useDomMotionEvents2 = _slicedToArray(_useDomMotionEvents, 1),\n      patchMotionEvents = _useDomMotionEvents2[0]; // ============================= Step =============================\n\n\n  var eventHandlers = React.useMemo(function () {\n    var _ref2, _ref3, _ref4;\n\n    switch (status) {\n      case 'appear':\n        return _ref2 = {}, _defineProperty(_ref2, STEP_PREPARE, onAppearPrepare), _defineProperty(_ref2, STEP_START, onAppearStart), _defineProperty(_ref2, STEP_ACTIVE, onAppearActive), _ref2;\n\n      case 'enter':\n        return _ref3 = {}, _defineProperty(_ref3, STEP_PREPARE, onEnterPrepare), _defineProperty(_ref3, STEP_START, onEnterStart), _defineProperty(_ref3, STEP_ACTIVE, onEnterActive), _ref3;\n\n      case 'leave':\n        return _ref4 = {}, _defineProperty(_ref4, STEP_PREPARE, onLeavePrepare), _defineProperty(_ref4, STEP_START, onLeaveStart), _defineProperty(_ref4, STEP_ACTIVE, onLeaveActive), _ref4;\n\n      default:\n        return {};\n    }\n  }, [status]);\n\n  var _useStepQueue = useStepQueue(status, function (newStep) {\n    // Only prepare step can be skip\n    if (newStep === STEP_PREPARE) {\n      var onPrepare = eventHandlers[STEP_PREPARE];\n\n      if (!onPrepare) {\n        return SkipStep;\n      }\n\n      return onPrepare(getDomElement());\n    } // Rest step is sync update\n\n\n    // Rest step is sync update\n    if (step in eventHandlers) {\n      var _eventHandlers$step;\n\n      setStyle(((_eventHandlers$step = eventHandlers[step]) === null || _eventHandlers$step === void 0 ? void 0 : _eventHandlers$step.call(eventHandlers, getDomElement(), null)) || null);\n    }\n\n    if (step === STEP_ACTIVE) {\n      // Patch events when motion needed\n      patchMotionEvents(getDomElement());\n\n      if (motionDeadline > 0) {\n        clearTimeout(deadlineRef.current);\n        deadlineRef.current = setTimeout(function () {\n          onInternalMotionEnd({\n            deadline: true\n          });\n        }, motionDeadline);\n      }\n    }\n\n    return DoStep;\n  }),\n      _useStepQueue2 = _slicedToArray(_useStepQueue, 2),\n      startStep = _useStepQueue2[0],\n      step = _useStepQueue2[1];\n\n  var active = isActive(step);\n  activeRef.current = active; // ============================ Status ============================\n  // Update with new status\n\n  useIsomorphicLayoutEffect(function () {\n    setAsyncVisible(visible);\n    var isMounted = mountedRef.current;\n    mountedRef.current = true;\n\n    if (!supportMotion) {\n      return;\n    }\n\n    var nextStatus; // Appear\n\n    if (!isMounted && visible && motionAppear) {\n      nextStatus = STATUS_APPEAR;\n    } // Enter\n\n\n    if (isMounted && visible && motionEnter) {\n      nextStatus = STATUS_ENTER;\n    } // Leave\n\n\n    if (isMounted && !visible && motionLeave || !isMounted && motionLeaveImmediately && !visible && motionLeave) {\n      nextStatus = STATUS_LEAVE;\n    } // Update to next status\n\n\n    if (nextStatus) {\n      setStatus(nextStatus);\n      startStep();\n    }\n  }, [visible]); // ============================ Effect ============================\n  // Reset when motion changed\n\n  useEffect(function () {\n    if ( // Cancel appear\n    status === STATUS_APPEAR && !motionAppear || // Cancel enter\n    status === STATUS_ENTER && !motionEnter || // Cancel leave\n    status === STATUS_LEAVE && !motionLeave) {\n      setStatus(STATUS_NONE);\n    }\n  }, [motionAppear, motionEnter, motionLeave]);\n  useEffect(function () {\n    return function () {\n      clearTimeout(deadlineRef.current);\n      destroyedRef.current = true;\n    };\n  }, []); // Trigger `onVisibleChanged`\n\n  useEffect(function () {\n    if (asyncVisible !== undefined && status === STATUS_NONE) {\n      onVisibleChanged === null || onVisibleChanged === void 0 ? void 0 : onVisibleChanged(asyncVisible);\n    }\n  }, [asyncVisible, status]); // ============================ Styles ============================\n\n  var mergedStyle = style;\n\n  if (eventHandlers[STEP_PREPARE] && step === STEP_START) {\n    mergedStyle = _objectSpread({\n      transition: 'none'\n    }, mergedStyle);\n  }\n\n  return [status, step, mergedStyle, asyncVisible !== null && asyncVisible !== void 0 ? asyncVisible : visible];\n}"],"sourceRoot":""}